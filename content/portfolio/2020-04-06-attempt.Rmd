---
title: "Data Viz Project: Bankruptcy Report Revamp"
author: Kolton Bodnovich
date: '2020-04-06'
slug: 
categories: []
tags: []
image: ''
showonlyimage: no
---

```{r inputs, include=FALSE}
library(tidyverse)
library(scales)
library(plotly)
library(readr)

bank_theme <- theme(axis.text.y = element_text(size = rel(1.15)),
        axis.text.x = element_text(face = 'bold', size = rel(1.1)), 
        axis.title.x = element_text(size = 15, face = "bold", margin = margin(t = 10)), 
        axis.title.y = element_text(size = 13, face = "bold", margin = margin(r = 5)),
        panel.background = element_rect(fill = "white"),
        panel.grid.major.y = element_blank(),
        panel.grid.major.x = element_blank(),
        plot.title = element_text(hjust = 0.5, size = 12, face = "bold"))

```



### Bar Charts

![](/portfolio/2020-04-06-attempt_files/B4_old.jpg)

```{r B4 data, include=FALSE}

B4_data <- read_csv("B4_data.csv", col_types = cols(X1 = col_skip()))

B4_data$Receipts <- B4_data$Receipts / 1000000 

```

```{r B4_bar, echo=FALSE, message=FALSE}

B4 <- ggplot(B4_data, aes(x = factor(year_closed), y = Receipts)) +
  geom_col(fill = 'green', color = 'black') +
  geom_text(aes(label = scales::dollar(Receipts, accuracy = 1)), vjust = -.5, size = 2.8) +
  xlab('CALENDAR YEAR') +
  ylab('RECEIPTS (IN MILLIONS)') +
  scale_y_continuous(breaks = c(500, 1000, 1500, 2000, 2500, 3000, 3500, 4000),
                     labels = scales::dollar_format(prefix = "$")) +
  ggtitle("TOTAL RECEIPTS IN ASSET CASES CLOSED\nCALENDAR YEARS 2001 - 2018")


B4 + bank_theme

```

![](/portfolio/2020-04-06-attempt_files/b7_bar_old.jpg)

```{r B7 data, include=FALSE}
b7_data <- read_csv("b7_data.csv", 
    col_types = cols(X1 = col_skip()))

```

```{r B7 Chart, echo=FALSE, message=FALSE}

B7 <- ggplot(b7_data, aes(x = factor(year_closed), y = LG_perc)) +
  geom_col(fill = 'blue', color = 'black') +
  geom_text(aes(label = scales::percent(LG_perc, accuracy = 3)), vjust = -.5, size = 2.8) +
  xlab('CALENDAR YEAR') +
  ylab('% OF TOTAL RECEIPTS') +
  scale_y_continuous(breaks = c(0, .10, .20, .30, .40, .50, .60, .70, .80),
                     labels = scales::label_percent()) +
  ggtitle("% OF TOTAL $ IN LARGEST CASES\nCALENDAR YEARS 2001 - 2018")

B7 + bank_theme

```

```{r B12 data, echo=FALSE, message=FALSE}
library(readr)
b3 <- B12_data <- read_csv("B12_data.csv", 
    col_types = cols(X1 = col_skip()))

b_text <- B12_textgeom_data <- read_csv("B12_textgeom_data.csv", 
    col_types = cols(X1 = col_skip()))
```


```{r B12 Chart, echo=FALSE, message=FALSE}

ggplot(b3, aes(x = size, y = value)) + 
  geom_col(aes(fill = variable),color = "black", width  = 0.6) +
  scale_fill_manual(values = c(Secured = "blue", Priority = "red", Unsecured = "yellow")) +
  theme(axis.text.x = element_text(size = rel(1.5), color = 'black'), 
        axis.text.y = element_text(size = rel(1.5), color = 'black'),
        axis.title.x = element_text(size = 17, face = "bold", margin = margin(t = 10)), 
        axis.title.y = element_text(size = 17, face = "bold", margin = margin(r = 15)),
        legend.position = "bottom",
        legend.title = element_blank(),
        legend.background = element_rect(fill = "white", color = "black"),
        legend.text = element_text(size = 17),
        panel.background = element_rect(fill = "white"),
        panel.grid.major.y = element_line(color = "black"),
        plot.title = element_text(hjust = 0.5, size = 17, face = "bold")) +
  xlab("SIZE OF CASE") +
  ylab("% OF TOTAL RECEIPTS") +
  guides(fill = guide_legend(reverse = T)) +
  ggtitle("DISTRIBUTION BY TYPE AND AMOUNT\nCALENDAR YEARS 2001 - 2018") +
  scale_y_continuous(breaks = c(0, 10, 20, 30, 40, 50, 60, 70),
                     labels = c("0%", "10%", "20%", "30%", "40%", "50%", "60%", "70%")) +
  geom_text(aes(x = size, y = perc_cr, label = paste(format(perc_cr, digits = 3), "%"))
            , fontface = "bold", data = b_text, nudge_y = 2, size = 5)
```


### Maps

![](/portfolio/2020-04-06-attempt_files/b2_map_old.jpg)
